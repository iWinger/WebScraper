import smtplib, ssl
from bs4 import BeautifulSoup
import requests
import base64
import time
import re
from scraper import price

def comparePrice(url,companyName):
    item_list, image_list, price_list = content(url)

    if(item_list):
        company_list = []
        for i in range(len(item_list)):
            if item_list[i] in companyName:
                company_list.append(item_list[i])

        price = ''
        if(len(price_list[i])>6):
            comma = price_list[i].find(',')
            price = str(price_list[i][1:comma] + price_list[i][comma+1:])

        minPrice = float(price)
        index = 0
        for i in range(len(price_list)):

            price = ''
            if(len(price_list[i])>6):
                comma = price_list[i].find(',')
                price = str(price_list[i][1:comma] + price_list[i][comma+1:])
            newPrice = float(price)
            if(newPrice<minPrice and (item_list[i] in company_list)):
                minPrice = newPrice
                index = i

        return item_list[index],image_list[index],price_list[index]
    else:
        print("ERROR: No entries found in url")
        return None,None,None
